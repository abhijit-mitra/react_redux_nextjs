{"ast":null,"code":"import Router from 'next/router';\nimport actions from '../redux/actions';\nimport { getCookie } from '../utils/cookie'; // checks if the page is being loaded on the server, and if so, get auth token from the cookie:\n\nexport default function (ctx) {\n  if (ctx.isServer) {\n    if (ctx.req.headers.cookie) {\n      ctx.store.dispatch(actions.reauthenticate(getCookie('token', ctx.req)));\n    }\n  } else {\n    const token = ctx.store.getState().authentication.token;\n\n    if (token && (ctx.pathname === '/signin' || ctx.pathname === '/signup')) {\n      setTimeout(function () {\n        Router.push('/');\n      }, 0);\n    }\n  }\n}","map":{"version":3,"sources":["/Users/abhijit/Documents/Projects/React/ssr_next_js/utils/initialize.js"],"names":["Router","actions","getCookie","ctx","isServer","req","headers","cookie","store","dispatch","reauthenticate","token","getState","authentication","pathname","setTimeout","push"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,aAAnB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,SAASC,SAAT,QAA0B,iBAA1B,C,CAEA;;AACA,eAAe,UAASC,GAAT,EAAc;AAE3B,MAAGA,GAAG,CAACC,QAAP,EAAiB;AACf,QAAGD,GAAG,CAACE,GAAJ,CAAQC,OAAR,CAAgBC,MAAnB,EAA2B;AACzBJ,MAAAA,GAAG,CAACK,KAAJ,CAAUC,QAAV,CAAmBR,OAAO,CAACS,cAAR,CAAuBR,SAAS,CAAC,OAAD,EAAUC,GAAG,CAACE,GAAd,CAAhC,CAAnB;AACD;AACF,GAJD,MAIO;AACL,UAAMM,KAAK,GAAGR,GAAG,CAACK,KAAJ,CAAUI,QAAV,GAAqBC,cAArB,CAAoCF,KAAlD;;AAEA,QAAGA,KAAK,KAAKR,GAAG,CAACW,QAAJ,KAAiB,SAAjB,IAA8BX,GAAG,CAACW,QAAJ,KAAiB,SAApD,CAAR,EAAwE;AACtEC,MAAAA,UAAU,CAAC,YAAW;AACpBf,QAAAA,MAAM,CAACgB,IAAP,CAAY,GAAZ;AACD,OAFS,EAEP,CAFO,CAAV;AAGD;AACF;AAGF","sourcesContent":["import Router from 'next/router';\nimport actions from '../redux/actions';\nimport { getCookie } from '../utils/cookie';\n\n// checks if the page is being loaded on the server, and if so, get auth token from the cookie:\nexport default function(ctx) {\n\n  if(ctx.isServer) {\n    if(ctx.req.headers.cookie) {\n      ctx.store.dispatch(actions.reauthenticate(getCookie('token', ctx.req)));\n    }\n  } else {\n    const token = ctx.store.getState().authentication.token;\n\n    if(token && (ctx.pathname === '/signin' || ctx.pathname === '/signup')) {\n      setTimeout(function() {\n        Router.push('/');\n      }, 0);\n    }\n  }\n\n\n}\n"]},"metadata":{},"sourceType":"module"}